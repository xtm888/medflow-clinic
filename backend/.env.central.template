# =============================================================================
# MedFlow CENTRAL SERVER Configuration
# =============================================================================
# This is the cloud/central server that aggregates data from all clinics
# Deploy this on a reliable cloud server (AWS, DigitalOcean, etc.)
# =============================================================================

# -----------------------------------------------------------------------------
# SERVER IDENTIFICATION
# -----------------------------------------------------------------------------
SERVER_TYPE=central
SERVER_NAME=MedFlow Central Server

# -----------------------------------------------------------------------------
# SERVER CONFIGURATION
# -----------------------------------------------------------------------------
NODE_ENV=production
PORT=5001

# Frontend URL (admin dashboard for central management)
FRONTEND_URL=https://admin.medflow.cd

# -----------------------------------------------------------------------------
# DATABASE (Cloud MongoDB Atlas recommended)
# -----------------------------------------------------------------------------
# Use MongoDB Atlas for reliability and automatic backups
MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/medflow_central?retryWrites=true&w=majority

# Redis for caching (use managed Redis like Redis Cloud or ElastiCache)
REDIS_URL=redis://username:password@redis-host:6379

# -----------------------------------------------------------------------------
# SYNC SERVER CONFIGURATION
# -----------------------------------------------------------------------------
# This server acts as the central sync hub
SYNC_SERVER_MODE=central

# API keys for each clinic (comma-separated)
# Format: CLINIC_ID:API_KEY
SYNC_CLINIC_KEYS=KINSHASA_MAIN:key1,LUBUMBASHI:key2,GOMA:key3

# Enable automatic conflict resolution
AUTO_RESOLVE_CONFLICTS=true

# Data retention policy (days to keep sync history)
SYNC_HISTORY_RETENTION_DAYS=90

# -----------------------------------------------------------------------------
# AUTHENTICATION & SECURITY
# -----------------------------------------------------------------------------
JWT_SECRET=central-server-jwt-secret-must-be-very-strong
JWT_EXPIRE=15m
REFRESH_TOKEN_SECRET=central-server-refresh-secret-different-from-jwt
REFRESH_TOKEN_EXPIRE=30d
SESSION_SECRET=central-session-secret-change-in-production
ENCRYPTION_KEY=central-encryption-key-32-chars!!

# Rate limiting (stricter for central server)
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# -----------------------------------------------------------------------------
# EMAIL CONFIGURATION
# -----------------------------------------------------------------------------
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USER=central@medflow.cd
EMAIL_PASS=your-app-password

# -----------------------------------------------------------------------------
# MONITORING & ALERTS
# -----------------------------------------------------------------------------
# Slack webhook for sync alerts
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/xxx/yyy/zzz

# Email for critical alerts
ALERT_EMAIL=admin@medflow.cd

# -----------------------------------------------------------------------------
# BACKUP CONFIGURATION
# -----------------------------------------------------------------------------
BACKUP_SCHEDULE=0 */6 * * *
BACKUP_PATH=/backups
BACKUP_S3_BUCKET=medflow-backups

# AWS credentials for S3 backup
AWS_ACCESS_KEY_ID=your-aws-access-key
AWS_SECRET_ACCESS_KEY=your-aws-secret-key
AWS_REGION=eu-west-1

# -----------------------------------------------------------------------------
# LOGGING
# -----------------------------------------------------------------------------
LOG_LEVEL=info
LOG_PATH=/var/log/medflow

# External logging (optional)
# LOGTAIL_TOKEN=your-logtail-token
# SENTRY_DSN=https://xxx@sentry.io/yyy
